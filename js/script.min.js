function getRecords(e,t,n){$.ajax({url:"php/getRecords.php",type:"POST",dataType:"json",data:{table:e,filters:n},success:function(n){switch(t){case"toTable":selectedTable=e,displayRecordsList(n.records);break;case"toSelectOptions":populateSelectOptions(n.records,e)}},error:function(e,t,n){console.log("request failed"),console.log(e)}})}function recordDetailsToPreviewMode(){var e=$(".recordDetails");e.find(".alert-info").addClass("d-none"),e.find(".createSuccess").addClass("d-none"),e.find(".createFailed").addClass("d-none"),e.find(".preview").removeClass("d-none"),e.find(".editable").addClass("d-none"),e.find("input, select").removeAttr("disabled"),e.find(".editBtn").removeClass("d-none"),e.find(".saveBtn").addClass("d-none"),e.find(".confirmBtn").addClass("d-none"),e.find(".duplicateBtn").removeClass("d-none"),e.find(".deleteBtn").addClass("d-none"),recalculateContentHeight()}function closeRecordDetailsAtDesktop(){Object.keys(nameTranslations).forEach(e=>{$(".recordDetails."+e+".desktop").removeClass("d-md-block")}),recalculateContentHeight(),$(".recordDetails").find(".createSuccess").hasClass("d-none")||getRecords(selectedTable,"toTable",activeFilters),recordDetailsToPreviewMode()}function getSelectedRecords(){for(var e=dataTable.rows({selected:!0}).data(),t=[],n=0;n<e.length;n++)t.push(e[n]);return t}function displaySelectedRecordsDetails(){var e=getSelectedRecords(),t={},n={};for(var o in e[0])n[o]="no",t[o]=e[0][o];e.forEach(function(e){for(var o in e)if("no"==n[o]&&e[o]!=t[o])switch(n[o]="yes",o){case"id":t[o]="#";break;case"email":t[o]="multiple@emails";break;default:t[o]="multiple"}});var a=$(".recordDetails."+selectedTable);a.find(".modal-title span").text(nameTranslations[selectedTable].displayName),a.find("#recordId").text(t.id);var l=nameTranslations[selectedTable].columnsList;for(var o in l){var s=t[o],d=l[o];a.find("input."+o).val(s).attr("placeholder",d+" placeholder"),a.find("span."+o).text(s),a.find("label."+o).text(d)}"departmentID"in t&&a.find("span.department").attr("id",t.departmentID),"locationID"in t&&a.find("span.location").attr("id",t.locationID),recordDetailsToPreviewMode()}function displayRecordsList(e){closeRecordDetailsAtDesktop(),closeColOrderPopover(),closeFilterPopover();var t=bootstrap.Modal.getInstance(document.getElementsByClassName("recordDetails "+selectedTable+" mobile")[0]);null!=t&&t.hide(),$("#searchBox > input").val(""),$("#showRecordsBtnM").addClass("d-none");var n=[],o=nameTranslations[selectedTable].columnsList,a=$("<thead></thead>"),l=$("<tr></tr>");for(var s in o)n.push({data:s}),l.append($("<th></th>").text(o[s]).attr("scope","col"));a.append(l);var d=$("<table></table>").attr("class","table table-hover");d.append(a),$("#content").html("").append(d),dataTable=$("#content > table").DataTable({destroy:!0,data:e,columns:n,paging:!1,scrollY:300,scrollX:!1,scrollCollapse:!0,drawCallback:function(e,t){$("div.dataTables_info").addClass("d-none"),recalculateContentHeight()},infoCallback:function(e,t,n,o,a,l){return $("#totalRecords span").text(o),$("#foundRecords span").text(a),""},responsive:!0,colReorder:!0,select:{style:"multi+shift"},searchPanes:!0,dom:"lrtip",keys:!0}).on("select",function(){updateSelectInfo(),displaySelectedRecordsDetails(),$(".recordDetails."+selectedTable+".desktop").addClass("d-md-block"),recalculateContentHeight(),$("#showRecordsBtnM").removeClass("d-none")}).on("deselect",function(e,t,n,o){updateSelectInfo(),t.rows({selected:!0}).data().length>0?(displaySelectedRecordsDetails(),$(".recordDetails"+selectedTable+".desktop").addClass("d-md-block"),recalculateContentHeight(),$("#showRecordsBtnM").removeClass("d-none")):(closeRecordDetailsAtDesktop(),$("#showRecordsBtnM").addClass("d-none"))}),$("#tableSelectionDropdown > a > span").text(nameTranslations[selectedTable].displayName)}function getHeighConsumedByOtherElements(e){var t=0;e.siblings().each(function(e){$(this).is(":visible")&&!$(this).hasClass("popover")&&(t+=$(this).outerHeight(!0))});var n=e.parent(),o=-n.height();n.is("body")?o+=n.outerHeight():o+=n.outerHeight(!0);var a=t+o;return n.is("html")?a:a+getHeighConsumedByOtherElements(n)}function recalculateContentHeight(){var e=$("#content .dataTables_scrollBody");if(e.parents().length>0){var t=getHeighConsumedByOtherElements(e),n=$("html").outerHeight(!0),o=n-t;o>0?e.css("max-height",o):setTimeout(function(){recalculateContentHeight()},100)}e.css("overflow-x","hidden")}function updateSelectInfo(){var e=$("div.dataTables_info").addClass("d-none").find(".select-info:first-child").text(),t=e.search("row");if(t>0){var n=e.slice(0,t-1),o=Number(n);o>0?($("#selectedRecords").removeClass("d-none"),$("#selectedRecords span").text(o)):$("#selectedRecords").addClass("d-none")}else $("#selectedRecords").addClass("d-none")}function updateContentForColOrder(){var e=$("#colOrderAtMobile, #colOrderAtDesktop"),t=e.find("ul").html(""),n=dataTable.columns().visible(),o={column:[]};dataTable.columns().header().each(function(e,t){o.column.push({index:dataTable.colReorder.transpose(t,"toOriginal"),name:e.innerText,visible:n[t]})});const a=$("#colOrderTemplate").html(),l=Handlebars.compile(a);t.append(l(o))}function updateColumnsOrder(e,t){var n=t.item[0].parentNode,o=[];$(n).children().each(function(e,t){o.push(t.value)}),dataTable.colReorder.order(o,!0).draw()}function updateColumnsVisibility(e){var t=e.target.value,n=dataTable.colReorder.transpose(parseInt(t)),o=e.target.checked;dataTable.column(n).visible(o).draw()}function moveUpColumn(e){var t;t=$(e.target).is("button")?e.target:e.target.parentElement;var n=dataTable.colReorder.transpose(parseInt(t.value)),o=n-1;o<0&&(o=0),dataTable.colReorder.move(n,o).draw();var a=t.closest("li"),l=$(a).prev();null!=l&&$(a).insertBefore(l)}function moveDownColumn(e){var t;t=$(e.target).is("button")?e.target:e.target.parentElement;var n=dataTable.colReorder.transpose(parseInt(t.value)),o=n+1,a=dataTable.columns()[0].length-1;o>=a&&(o=a),dataTable.colReorder.move(n,o).draw();var l=t.closest("li"),s=$(l).next();null!=s&&$(l).insertAfter(s)}function assignActionsForColOrder(e){e.find("ul").sortable({update:updateColumnsOrder}),e.find("input").on("click",updateColumnsVisibility),e.find(".btn-up").on("click",moveUpColumn),e.find(".btn-down").on("click",moveDownColumn)}function closeColOrderPopover(){var e=document.getElementById("colOrderBtn"),t=bootstrap.Popover.getInstance(e);t.hide()}function initiateColOrderPopover(){bootstrap.Tooltip.Default.allowList.button=["type","value"],bootstrap.Tooltip.Default.allowList.input=["type","checked","value"],bootstrap.Tooltip.Default.allowList.label=["for"],bootstrap.Tooltip.Default.allowList.li=["value"];var e=document.getElementById("colOrderBtn");new bootstrap.Popover(e,{content:function(){return $("#colOrderAtDesktop").html()},html:!0,trigger:"manual"}),e.addEventListener("shown.bs.popover",function(){var e=bootstrap.Popover.getInstance(this),t=$(e.tip);t.find(".closeBtn").on("click",closeColOrderPopover),assignActionsForColOrder(t),$(t).css("max-width","1000px")})}function initiateFilterPopover(){bootstrap.Tooltip.Default.allowList.button=["type","value"],bootstrap.Tooltip.Default.allowList.input=["type","checked","value"],bootstrap.Tooltip.Default.allowList.label=["for"],bootstrap.Tooltip.Default.allowList.table=[],bootstrap.Tooltip.Default.allowList.thead=[],bootstrap.Tooltip.Default.allowList.tbody=[],bootstrap.Tooltip.Default.allowList.tr=["value"],bootstrap.Tooltip.Default.allowList.th=[],bootstrap.Tooltip.Default.allowList.td=[];var e=document.getElementById("filterRecordsBtnD");new bootstrap.Popover(e,{content:function(){return $(".filter.desktop").html()},html:!0,trigger:"manual",boundary:document.querySelector("#content")}),e.addEventListener("shown.bs.popover",function(){var e=bootstrap.Popover.getInstance(this),t=$(e.tip);t.find(".closeBtn").on("click",closeFilterPopover),t.find(".applyBtn").on("click",applyFilter),t.find(".clearAllBtn").on("click",function(){clearAllFilters(),getRecords(selectedTable,"toTable",activeFilters)}),applyActionsForFilters(t),$(t).css("max-width","1000px"),e.update()})}function updateContentForFilter(){var e=$(".filter"),t=e.find("tbody").html(""),n={column:[]};Object.keys(nameTranslations[selectedTable].columnsList).forEach(function(e){var t=!1,o="";activeFilters.forEach(function(n){n.key==e&&(t=!0,o=n.query)}),n.column.push({key:e,name:nameTranslations[selectedTable].columnsList[e],active:t,query:o})});const o=$("#filterTemplate").html(),a=Handlebars.compile(o);t.append(a(n))}function closeFilterPopover(){var e=document.getElementById("filterRecordsBtnD"),t=bootstrap.Popover.getInstance(e);t.hide()}function applyFilter(){var e=$(this).closest(".filter-content").find("tbody");activeFilters=[],e.children().each(function(e,t){var n=$(t).find(".form-check-input").is(":checked");if(n){var o=$(t).attr("value"),a=$(t).find(".form-control").val();activeFilters.push({key:o,query:a})}});var t=activeFilters.length;0==t&&(t=""),$("#filterRecordsBtnD span").text(t),$("#filterRecordsBtnM span").text(t),getRecords(selectedTable,"toTable",activeFilters)}function clearAllFilters(){activeFilters=[],$("#filterRecordsBtnD span").text(""),$("#filterRecordsBtnM span").text("")}function applyActionsForFilters(e){e.find(".form-control").on("keyup",function(e){var t=$(e.target),n=t.closest("tr").find(".form-check-input");""!=t.val()?n.prop("checked",!0):n.prop("checked",!1)})}function recordDetailsToEditMode(){var e=$(".recordDetails");e.find(".alert-info").addClass("d-none"),e.find(".createSuccess").addClass("d-none"),e.find(".createFailed").addClass("d-none"),e.find(".editable").removeClass("d-none"),e.find(".preview").addClass("d-none"),e.find("input, select").removeAttr("disabled"),e.find(".editBtn").addClass("d-none"),e.find(".saveBtn").addClass("d-none"),e.find(".confirmBtn").removeClass("d-none"),e.find(".duplicateBtn").addClass("d-none"),e.find(".deleteBtn").removeClass("d-none"),recalculateContentHeight()}function populateSelectOptions(e,t){var n=$("select."+t);n.html(""),n.append($("<option></option>").val("pleaseSelect").text("Please select").addClass("d-none")),e.forEach(function(e){var t=$("<option></option>");for(var o in e)switch(o){case"id":t.val(e[o]);break;case"name":t.text(e[o]);break;default:t.attr(o,e[o])}n.append(t)}),n.append($("<option></option>").val("multiple").text("multiple").addClass("d-none")),n.val(n.next("span").attr("id"))}function determineValue(e,t,n){return t!=n?n:e}function showChanges(e,t){var n=$("<table></table>").attr("class","table"),o=$("<tbody></tbody>");n.append(o);var a=0,l=0;if(editedRecords.forEach(function(t){var n=!1,s=[];for(var d in t){var i=e[a][d],r=t[d];if(i!=r){var c,p,u;switch(n=!0,d){case"departmentID":c=$(".mobile select.department option[value="+i+"]").text(),p=$(".mobile select.department option[value="+r+"]").text(),u=nameTranslations.department.displayName;break;case"locationID":c=$(".mobile select.location option[value="+i+"]").text(),p=$(".mobile select.location option[value="+r+"]").text(),u=nameTranslations.location.displayName;break;default:c=i,p=r,u=nameTranslations[selectedTable].columnsList[d]}var f=$("<tr></tr>").append($("<td></td>").text(u)).append($("<td></td>").text(c)).append($("<td></td>").append($("<i></i>").addClass("bi bi-arrow-right"))).append($("<td></td>").text(p));s.push(f)}}if(a+=1,n){l+=1;var m=$("<tr></tr>").append($("<th></th>").text("Record ID: "+t.id));o.append(m),s.forEach(function(e){o.append(e)})}}),0==l){var s=t.find("div.alert-info").removeClass("d-none");recalculateContentHeight(),setTimeout(function(){s.addClass("d-none"),recalculateContentHeight()},3e3)}else t.hasClass("mobile")&&bootstrap.Modal.getInstance(document.getElementsByClassName("recordDetails "+selectedTable+" mobile")[0]).hide(),$("#confirmEdited span.number").text(l),$("#confirmEdited div.listOfChanges").html("").append(n),new bootstrap.Modal(document.getElementById("confirmEdited"),{backdrop:"static"}).show()}function updateDBsuccess(e){$("#confirmEdited .updateBtn").removeAttr("disabled").find("span").addClass("d-none"),"200"==e.status.code?($("#confirmEdited .alert-success").removeClass("d-none"),$("#confirmEdited .alert-warning").addClass("d-none"),$("#confirmEdited .updateBtn").addClass("d-none"),$("#confirmEdited .backBtn").addClass("d-none"),$("#confirmEdited .closeBtn").removeClass("d-none"),recordDetailsToPreviewMode(),getRecords(selectedTable,"toTable",activeFilters)):updateDBerror()}function updateDBerror(){$("#confirmEdited .updateBtn").removeAttr("disabled").find("span").addClass("d-none"),$("#confirmEdited .alert-success").addClass("d-none"),$("#confirmEdited .alert-warning").removeClass("d-none")}function duplicateDBsuccess(e){$("#confirmDuplication .duplicateBtn").removeAttr("disabled").find("span").addClass("d-none"),"201"==e.status.code?($("#confirmDuplication .duplicationMessage").addClass("d-none"),$("#confirmDuplication .alert-success").removeClass("d-none"),$("#confirmDuplication .alert-warning").addClass("d-none"),$("#confirmDuplication .duplicateBtn").addClass("d-none"),$("#confirmDuplication .backBtn").addClass("d-none"),$("#confirmDuplication .closeBtn").removeClass("d-none"),getRecords(selectedTable,"toTable",activeFilters)):duplicateDBerror()}function duplicateDBerror(){$("#confirmDuplication .duplicateBtn").removeAttr("disabled").find("span").addClass("d-none"),$("#confirmDuplication .alert-success").addClass("d-none"),$("#confirmDuplication .alert-warning").removeClass("d-none")}function getListOfIds(e){var t=[];return e.forEach(function(e){t.push(e.id)}),t}function deleteDBsuccess(e){switch($("#confirmDeletion .deleteBtn").removeAttr("disabled").find("span").addClass("d-none"),$("#confirmDeletion .releaseDependenciesBtn").removeAttr("disabled").find("span").addClass("d-none"),e.status.code){case"400":deleteDBerror();case"204":$("#confirmDeletion .alert-success").removeClass("d-none"),$("#confirmDeletion .alert-warning").addClass("d-none"),$("#confirmDeletion .deleteBtn").addClass("d-none"),$("#confirmDeletion .backBtn").addClass("d-none"),$("#confirmDeletion .closeBtn").removeClass("d-none"),$("#confirmDeletion .deleteMessage").addClass("d-none"),$("#confirmDeletion .dependenciesDetails").addClass("d-none"),$("#confirmDeletion .releaseDependenciesBtn").addClass("d-none"),getRecords(selectedTable,"toTable",activeFilters);break;case"202":$("#confirmDeletion .alert-success").addClass("d-none"),$("#confirmDeletion .alert-warning.dependencies").removeClass("d-none"),$("#confirmDeletion .alert-warning.error").addClass("d-none"),$("#confirmDeletion .deleteBtn").addClass("d-none"),$("#confirmDeletion .editDependenciesBtn").removeClass("d-none"),$("#confirmDeletion .deleteMessage").addClass("d-none"),$("#confirmDeletion .dependenciesDetails").addClass("d-none"),$("#confirmDeletion .releaseDependenciesBtn").addClass("d-none");var t=e.recordsWithDependencies,n=e.alternatives,o=Object.keys(t).length;$("#confirmDeletion span.numberOfRecorsWithDependencies").text(o);var a=$("#confirmDeletion .dependenciesDetails").html("");for(var l in t){var s,d,i=t[l].dependencies,r=t[l].value;1==i.length?(s="is 1 record",d="it"):(s="are "+i.length+" records",d="them");var c=r+" "+nameTranslations[selectedTable].displayName,p="There "+s+" dependend on "+c+", which you selected to delete. Where you would like to move "+d+"?";a.append($("<p></p>").text(p));var u=$("<select></select>").addClass("form-select").attr("id",l);0==n.length?u.append($("<option></option>").val("unchange").text("No alternatives available.").addClass("d-none")):(u.append($("<option></option>").val("unchange").text("Please select alternative").addClass("d-none")),n.forEach(function(e){var t=e.name;"location"in e&&(t+=" ("+e.location+")"),u.append($("<option></option>").val(e.id).text(t))})),u.append($("<option></option>").val("unchange").text("Leave unchanged")),a.append(u),a.append($("<hr>"))}}}function deleteDBerror(){$("#confirmDeletion .deleteBtn").removeAttr("disabled").find("span").addClass("d-none"),$("#confirmDeletion .releaseDependenciesBtn").removeAttr("disabled").find("span").addClass("d-none"),$("#confirmDeletion .alert-success").addClass("d-none"),$("#confirmDeletion .alert-warning.dependencies").addClass("d-none"),$("#confirmDeletion .alert-warning.error").removeClass("d-none"),$("#confirmDeletion .deleteMessage").addClass("d-none")}function recordDetailsToCreateMode(){var e=$(".recordDetails."+selectedTable);e.find(".modal-title span").text(nameTranslations[selectedTable].displayName),e.find("#recordId").text("new");var t=nameTranslations[selectedTable].columnsList;for(var n in t){var o="",a=t[n];e.find("input."+n).val(o).attr("placeholder",a+" placeholder"),e.find("span."+n).text(o).attr("id","pleaseSelect"),e.find("label."+n).text(a)}switch(selectedTable){case"personnel":getRecords("department","toSelectOptions",[]);break;case"department":getRecords("location","toSelectOptions",[])}e.find(".alert-info").addClass("d-none"),e.find(".createSuccess").addClass("d-none"),e.find(".createFailed").addClass("d-none"),e.find(".editable").removeClass("d-none"),e.find(".preview").addClass("d-none"),e.find("input, select").removeAttr("disabled"),e.find(".editBtn").addClass("d-none"),e.find(".saveBtn").removeClass("d-none"),e.find(".confirmBtn").addClass("d-none"),e.find(".duplicateBtn").addClass("d-none"),e.find(".deleteBtn").addClass("d-none")}function createRecord(e){$(".recordDetails .saveBtn").attr("disabled","true").find("span").removeClass("d-none"),$.ajax({url:"php/createRecord.php",type:"POST",dataType:"json",data:{table:selectedTable,record:e},success:createDBsuccess,error:function(e,t,n){console.log("request failed"),console.log(e),createDBerror()}})}function createDBsuccess(e){$(".recordDetails .saveBtn").removeAttr("disabled").find("span").addClass("d-none"),"201"==e.status.code?($(".recordDetails").find(".createSuccess").removeClass("d-none"),$(".recordDetails").find(".createFailed").addClass("d-none"),$(".recordDetails .saveBtn").addClass("d-none"),$(".recordDetails").find("input, select").attr("disabled","true"),$(".recordDetails").find("#recordId").text(e.record.id),recalculateContentHeight()):createDBerror()}function createDBerror(){$(".recordDetails .saveBtn").removeAttr("disabled").find("span").addClass("d-none"),$(".recordDetails").find(".createFailed").removeClass("d-none"),$(".recordDetails").find(".createSuccess").addClass("d-none"),recalculateContentHeight()}var dataTable,selectedTable,editedRecords,nameTranslations={personnel:{displayName:"Personnel",columnsList:{firstName:"First Name",lastName:"Last Name",jobTitle:"Job Title",email:"E-mail",department:"Department",location:"Location"}},department:{displayName:"Department",columnsList:{name:"Department Name",location:"Location"}},location:{displayName:"Location",columnsList:{name:"Location Name"}}},activeFilters=[];$(window).on("load",function(){for(var e in nameTranslations){var t=$("<a></a>").attr("class","dropdown-item").attr("value",e).text(nameTranslations[e].displayName),n=$("<li></li>").append(t);$("#tableSelectionDropdown > ul").append(n)}getRecords("personnel","toTable",[]),initiateColOrderPopover(),initiateFilterPopover(),$("#preloader").length&&$("#preloader").delay(100).fadeOut("slow",function(){$(this).remove()})}),$("#tableSelectionDropdown > ul").on("click","li",function(e){var t=e.target.attributes.value.value;t!=selectedTable&&clearAllFilters(),getRecords(e.target.attributes.value.value,"toTable",activeFilters)}),$(".recordDetails").on("hidden.bs.modal",function(){$(".recordDetails").find(".createSuccess").hasClass("d-none")||getRecords(selectedTable,"toTable",activeFilters),recordDetailsToPreviewMode()}),$(".recordDetails.desktop button.btn-close").on("click",closeRecordDetailsAtDesktop),$("#showRecordsBtnM").on("click",function(){closeColOrderPopover(),closeFilterPopover(),displaySelectedRecordsDetails(),new bootstrap.Modal(document.getElementsByClassName(selectedTable+" mobile")[0]).show()}),$(window).resize(function(){closeColOrderPopover(),closeFilterPopover(),recalculateContentHeight()}),$("#navbarSupportedContent").on("shown.bs.collapse",function(){recalculateContentHeight()}),$("#navbarSupportedContent").on("hidden.bs.collapse",function(){recalculateContentHeight()}),$("#navbarSupportedContent li.dropdown").on("shown.bs.dropdown",function(){recalculateContentHeight()}),$("#navbarSupportedContent li.dropdown").on("hidden.bs.dropdown",function(){recalculateContentHeight()}),$("#searchBox > input").on("keyup",function(e){dataTable.search(e.target.value).draw()}),$("#searchBox > input").on("change",function(e){dataTable.search(e.target.value).draw()}),$("#selectAll").on("click",function(){dataTable.rows({search:"applied"}).select().draw()}),$("#selectNone").on("click",function(){dataTable.rows().deselect().draw()}),$("#selectInverse").on("click",function(){var e=dataTable.rows({selected:!0}).indexes();dataTable.rows({search:"applied"}).select().rows(e).deselect().draw()}),$("#sortRecordsBtnM").on("click",function(){closeColOrderPopover(),closeFilterPopover(),new bootstrap.Modal(document.getElementById("sortAtMobile")).show();var e=dataTable.order(),t=dataTable.columns().visible(),n=dataTable.columns().responsiveHidden(),o=e[0][0];$("#sortByColumns").html(""),dataTable.columns().header().each(function(e,a){if(t[a]){var l=$("<option></option>").val(a);a==o&&l.prop("selected",!0),n[a]?l.text(e.innerText):l.text(e.innerText+" (hidden)"),$("#sortByColumns").append(l)}});var a=e[0][1];$('#sortDirection option[value="'+a+'"]').prop("selected",!0)}),$("#sortByColumns").on("change",function(){var e=dataTable.columns().responsiveHidden();e[$("#sortByColumns").val()]?$("#sortAtMobile .modal-body div:last-child").addClass("d-none"):$("#sortAtMobile .modal-body div:last-child").removeClass("d-none")}),$("#sortConfirmBtnM").on("click",function(){var e=parseInt($("#sortByColumns").val()),t=$("#sortDirection").val(),n=dataTable.columns().responsiveHidden();n[e]?dataTable.order([e,t]).draw():(dataTable.colReorder.move(e,0),dataTable.order([0,t]).draw())}),$("#colOrderBtn").on("click",function(){if(updateContentForColOrder(),$("nav .navbar-toggler").is(":visible"))assignActionsForColOrder($("#colOrderAtMobile")),new bootstrap.Modal(document.getElementById("colOrderAtMobile")).show();else{var e=document.getElementById("colOrderBtn"),t=bootstrap.Popover.getInstance(e);t.show()}}),$("#filterRecordsBtnD").on("click",function(){updateContentForFilter();var e=document.getElementById("filterRecordsBtnD"),t=bootstrap.Popover.getInstance(e);t.show()}),$("#filterRecordsBtnM").on("click",function(){updateContentForFilter(),applyActionsForFilters($(".filter.mobile")),new bootstrap.Modal(document.getElementsByClassName("filter mobile")[0]).show()}),$(".filter.mobile .applyBtn").on("click",applyFilter),$(".filter.mobile .clearAllBtn").on("click",function(){clearAllFilters(),getRecords(selectedTable,"toTable",activeFilters)}),$(".recordDetails").find(".editBtn").on("click",function(){recordDetailsToEditMode()}),$(".recordDetails.department").find(".editBtn").on("click",function(){getRecords("location","toSelectOptions",[])}),$(".recordDetails.personnel").find(".editBtn").on("click",function(){getRecords("department","toSelectOptions",[])}),$("select.department").change(function(){var e=$(this).find(":selected").attr("location"),t=$(this).find(":selected").attr("locationId"),n=$(this).closest(".recordDetails").find("span.location");n.text(e).attr("id",t)}),$(".recordDetails.personnel").find(".confirmBtn").on("click",function(){var e=$(this).closest(".recordDetails"),t=getSelectedRecords();editedRecords=[],t.forEach(function(t){var n={};n.id=t.id;var o=t.firstName,a=e.find("span.firstName").text(),l=e.find("input.firstName").val();n.firstName=determineValue(o,a,l);o=t.lastName,a=e.find("span.lastName").text(),l=e.find("input.lastName").val();n.lastName=determineValue(o,a,l);o=t.jobTitle,a=e.find("span.jobTitle").text(),l=e.find("input.jobTitle").val();n.jobTitle=determineValue(o,a,l);o=t.email,a=e.find("span.email").text(),l=e.find("input.email").val();n.email=determineValue(o,a,l);o=t.departmentID,a=e.find("span.department").attr("id"),l=e.find("select.department").val();n.departmentID=determineValue(o,a,l),editedRecords.push(n)}),showChanges(t,e)}),$(".recordDetails.department").find(".confirmBtn").on("click",function(){var e=$(this).closest(".recordDetails"),t=getSelectedRecords();editedRecords=[],t.forEach(function(t){var n={};n.id=t.id;var o=t.name,a=e.find("span.name").text(),l=e.find("input.name").val();n.name=determineValue(o,a,l);o=t.locationID,a=e.find("span.location").attr("id"),l=e.find("select.location").val();n.locationID=determineValue(o,a,l),editedRecords.push(n)}),showChanges(t,e)}),$(".recordDetails.location").find(".confirmBtn").on("click",function(){var e=$(this).closest(".recordDetails"),t=getSelectedRecords();editedRecords=[],t.forEach(function(t){var n={};n.id=t.id;var o=t.name,a=e.find("span.name").text(),l=e.find("input.name").val();n.name=determineValue(o,a,l),editedRecords.push(n)}),showChanges(t,e)}),$("#confirmEdited .btn-close, #confirmEdited .backBtn").on("click",function(){$("nav .navbar-toggler").is(":visible")&&new bootstrap.Modal(document.getElementsByClassName("recordDetails "+selectedTable+" mobile")[0]).show(),recordDetailsToEditMode()}),$("#confirmEdited .updateBtn").on("click",function(){$(this).attr("disabled","true").find("span").removeClass("d-none"),$.ajax({url:"php/updateRecords.php",type:"POST",dataType:"json",data:{table:selectedTable,records:editedRecords},success:updateDBsuccess,error:function(e,t,n){console.log("request failed"),console.log(e),updateDBerror()}})}),$("#confirmEdited").on("hidden.bs.modal",function(){$("#confirmEdited .alert-success").addClass("d-none"),$("#confirmEdited .alert-warning").addClass("d-none"),$("#confirmEdited .updateBtn").removeClass("d-none"),$("#confirmEdited .backBtn").removeClass("d-none"),$("#confirmEdited .closeBtn").addClass("d-none")}),$(".recordDetails").find(".duplicateBtn").on("click",function(){var e=$(this).closest(".recordDetails"),t=getSelectedRecords();e.hasClass("mobile")&&bootstrap.Modal.getInstance(document.getElementsByClassName("recordDetails "+selectedTable+" mobile")[0]).hide(),$("#confirmDuplication span.number").text(t.length),new bootstrap.Modal(document.getElementById("confirmDuplication"),{backdrop:"static"}).show()}),$("#confirmDuplication .btn-close, #confirmDuplication .backBtn").on("click",function(){$("nav .navbar-toggler").is(":visible")&&new bootstrap.Modal(document.getElementsByClassName(" recordDetails "+selectedTable+" mobile")[0]).show()}),$("#confirmDuplication .duplicateBtn").on("click",function(){var e=getSelectedRecords();$(this).attr("disabled","true").find("span").removeClass("d-none"),$.ajax({url:"php/duplicateRecords.php",type:"POST",dataType:"json",data:{table:selectedTable,records:e},success:duplicateDBsuccess,error:function(e,t,n){console.log("request failed"),console.log(e),duplicateDBerror()}})}),$("#confirmDuplication").on("hidden.bs.modal",function(){$("#confirmDuplication .duplicationMessage").removeClass("d-none"),$("#confirmDuplication .alert-success").addClass("d-none"),$("#confirmDuplication .alert-warning").addClass("d-none"),$("#confirmDuplication .duplicateBtn").removeClass("d-none"),$("#confirmDuplication .backBtn").removeClass("d-none"),$("#confirmDuplication .closeBtn").addClass("d-none")}),$(".recordDetails").find(".deleteBtn").on("click",function(){var e=$(this).closest(".recordDetails"),t=getListOfIds(getSelectedRecords());e.hasClass("mobile")&&bootstrap.Modal.getInstance(document.getElementsByClassName("recordDetails "+selectedTable+" mobile")[0]).hide(),$("#confirmDeletion span.numberOfRecordsToDelete").text(t.length),new bootstrap.Modal(document.getElementById("confirmDeletion"),{backdrop:"static"}).show()}),$("#confirmDeletion .btn-close, #confirmDeletion .backBtn").on("click",function(){$("nav .navbar-toggler").is(":visible")&&new bootstrap.Modal(document.getElementsByClassName("recordDetails "+selectedTable+" mobile")[0]).show(),recordDetailsToEditMode()}),$("#confirmDeletion .deleteBtn").on("click",function(){var e=getListOfIds(getSelectedRecords());$(this).attr("disabled","true").find("span").removeClass("d-none"),$.ajax({url:"php/deleteRecords.php",type:"POST",dataType:"json",data:{table:selectedTable,records:e,newDependency:{}},success:deleteDBsuccess,error:function(e,t,n){console.log("request failed"),console.log(e),deleteDBerror()}})}),$("#confirmDeletion").on("hidden.bs.modal",function(){$("#confirmDeletion .alert-success").addClass("d-none"),$("#confirmDeletion .alert-warning").addClass("d-none"),$("#confirmDeletion .deleteBtn").removeClass("d-none"),$("#confirmDeletion .backBtn").removeClass("d-none"),$("#confirmDeletion .closeBtn").addClass("d-none"),$("#confirmDeletion .editDependenciesBtn").addClass("d-none"),$("#confirmDeletion .dependenciesDetails").addClass("d-none"),$("#confirmDeletion .deleteMessage").removeClass("d-none"),$("#confirmDeletion .releaseDependenciesBtn").addClass("d-none")}),$("#confirmDeletion .editDependenciesBtn").on("click",function(){$("#confirmDeletion .alert-success").addClass("d-none"),$("#confirmDeletion .alert-warning").addClass("d-none"),$("#confirmDeletion .editDependenciesBtn").addClass("d-none"),$("#confirmDeletion .releaseDependenciesBtn").removeClass("d-none"),$("#confirmDeletion .dependenciesDetails").removeClass("d-none")}),$("#confirmDeletion .releaseDependenciesBtn").on("click",function(){$(this).attr("disabled","true").find("span").removeClass("d-none");var e=$("#confirmDeletion .dependenciesDetails").find("select"),t=[],n={};e.each(function(){var e=$(this).attr("id");t.push(e);var o=$(this).val();"unchange"!=o&&(n[e]=o)}),$.ajax({url:"php/deleteRecords.php",type:"POST",dataType:"json",data:{table:selectedTable,records:t,newDependency:n},success:deleteDBsuccess,error:function(e,t,n){console.log("request failed"),console.log(e),deleteDBerror()}})}),$("#addRecordBtnD").on("click",function(){recordDetailsToCreateMode(),$(".recordDetails."+selectedTable+".desktop").addClass("d-md-block"),recalculateContentHeight()}),$("#addRecordBtnM").on("click",function(){closeColOrderPopover(),closeFilterPopover(),recordDetailsToCreateMode(),new bootstrap.Modal(document.getElementsByClassName(selectedTable+" mobile")[0]).show()}),$(".recordDetails.personnel").find(".saveBtn").on("click",function(){var e=$(this).closest(".recordDetails"),t={};t.firstName=e.find("input.firstName").val(),t.lastName=e.find("input.lastName").val(),t.jobTitle=e.find("input.jobTitle").val(),t.email=e.find("input.email").val(),t.departmentID=e.find("select.department").val(),createRecord(t)}),$(".recordDetails.department").find(".saveBtn").on("click",function(){var e=$(this).closest(".recordDetails"),t={};t.name=e.find("input.name").val(),t.locationID=e.find("select.location").val(),createRecord(t)}),$(".recordDetails.location").find(".saveBtn").on("click",function(){var e=$(this).closest(".recordDetails"),t={};t.name=e.find("input.name").val(),createRecord(t)});